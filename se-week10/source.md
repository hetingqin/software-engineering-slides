# 软件工程及体系结构 · 第 10 周

## 安全、发布与运维

> 计算机相关专业本科/硕士 | 3 学时

---

## 第一讲：软件安全

### 1. 安全不是可选项

- 账号密码泄露事件频发（CSDN 600万、Equifax 1.47亿）
- 安全问题可能导致公司倒闭
- 安全应该从设计阶段就开始考虑（Secure by Design）

### 2. OWASP Top 10 常见安全威胁

1. **SQL 注入**：通过输入恶意 SQL 语句攻击数据库
2. **XSS（跨站脚本）**：在页面注入恶意 JavaScript
3. **CSRF（跨站请求伪造）**：伪造用户请求
4. **身份验证缺陷**：弱密码、Session 管理不当
5. **敏感数据泄露**：明文存储密码、未加密传输
6. **安全配置错误**：默认密码、多余服务开放
7. **不安全的组件**：使用有漏洞的第三方库
8. **不安全的反序列化**：恶意数据反序列化攻击
9. **日志和监控不足**：无法发现攻击行为
10. **服务端请求伪造 SSRF**

### 3. 安全防护基础措施

- 密码：加盐哈希（bcrypt），禁止明文存储
- 输入验证：所有用户输入都不可信
- HTTPS：全站加密传输
- 权限控制：最小权限原则
- 依赖安全：定期扫描第三方库漏洞（Snyk、Dependabot）
- 安全审计：代码安全审查、渗透测试

---

## 第二讲：版本发布

### 1. 软件上线只是新的开始

- 发布不是"扔上去就完了"
- 发布需要策略、流程和回滚方案

### 2. 语义化版本（SemVer）

- 格式：`MAJOR.MINOR.PATCH`（如 2.1.3）
- **MAJOR**：不兼容的 API 变更
- **MINOR**：向下兼容的功能新增
- **PATCH**：向下兼容的 Bug 修复

### 3. 发布策略

| 策略 | 做法 | 风险 | 适用 |
|------|------|------|------|
| **直接部署** | 替换旧版本 | 高 | 小型系统 |
| **蓝绿部署** | 两套环境切换 | 低 | 关键系统 |
| **金丝雀发布** | 先发给少量用户 | 低 | 大规模系统 |
| **滚动更新** | 逐台替换 | 中 | 容器化系统 |
| **A/B 测试** | 不同用户看不同版本 | 低 | 产品实验 |

### 4. 发布检查清单

- [ ] 所有测试通过
- [ ] 代码审查完成
- [ ] 数据库迁移脚本准备
- [ ] 回滚方案就绪
- [ ] 监控告警配置
- [ ] 发布说明撰写
- [ ] 相关人员通知

---

## 第三讲：DevOps

### 1. 什么是 DevOps？

- DevOps = Development + Operations 的结合
- 不是一个岗位，是一种**文化和实践**
- 目标：打破开发和运维的壁垒，加速交付

### 2. DevOps 核心原则

- **自动化**：一切能自动化的都要自动化
- **透明可测量**：指标可视化，数据驱动决策
- **协作**：开发、测试、运维紧密合作
- **快速反馈**：出问题第一时间知道
- **持续改进**：不断优化流程和工具

### 3. DevOps 工具链

```
计划 → 编码 → 构建 → 测试 → 发布 → 部署 → 运维 → 监控
Jira    Git   Maven   Jest   GitHub  Docker  K8s    Grafana
             Gradle  pytest Actions         Ansible Prometheus
```

### 4. Infrastructure as Code（IaC）

- 用代码定义和管理基础设施
- 工具：Terraform、Ansible、Pulumi
- 好处：可重复、可版本化、可审计

### 5. 容器化与编排

- **Docker**：将应用打包成容器，环境一致
- **Kubernetes（K8s）**：容器编排，自动伸缩、自愈
- 好处：开发环境 = 测试环境 = 生产环境

---

## 本周核心公式

> **DevOps** = 文化（协作）+ 自动化（CI/CD/IaC）+ 度量（监控/反馈）+ 共享（打破壁垒）

---

## 下周预告

🔧 **线上运维 & 复盘 & 小团队**：故障处理 → 日志管理 → 项目复盘方法论 → MVP 思维

✏️ **课后思考**：你的团队项目的安全风险有哪些？如何应对？
