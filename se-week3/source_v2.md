# 软件工程及体系结构 · 第 3 周

## 敏捷开发 & 质量管理：拥抱变化，持续交付价值

> 电子信息工程专业硕士 | 3 学时
> 主讲人 | 何庭钦 | 271880026@qq.com

---

## 第一讲：敏捷开发到底是想解决什么问题？

### 1. 敏捷开发：与其说是框架，不如说是价值观

很多人对敏捷开发存在误解，认为：
- 敏捷就是 Scrum 框架或极限编程 (XP)。
- 敏捷就是每天雷打不动地开站立会议、两周一个固定的 Sprint（冲刺/迭代）。
- 敏捷就是用看板软件（如 Jira）管理任务，或者把便签贴到白板上。

**事实上，敏捷不是一种工具或框架，也不是一套具体的过程，而是一套价值观和原则**。
各种框架和工具是“术”（手段），敏捷本身是“道”（指导决策的思想）。它旨在解决瀑布模型中**周期长、发布烦、变更难**的三大核心痛点。

### 2. 敏捷软件开发宣言与底层逻辑
2001 年，17 位轻量级软件开发流派领军人物聚集在雪鸟滑雪胜地，确立了四大核心价值观：
1. **个体和互动** 高于 流程和工具
2. **工作的软件** 高于 详尽的文档
3. **客户合作** 高于 合同谈判
4. **响应变化** 高于 遵循计划

*注：宣言右边的内容正是传统重型瀑布模型的核心。敏捷并非全盘否定右侧的价值，但更加看重左侧赋予的灵活性。*在 AI 时代，这套宣言依然适用，甚至更突出了“响应变化”的重要性——因为代码可用 AI 快速生成，试错成本被极具降低。

### 3. 用敏捷的方式“盖房子”（演进式交付）

敏捷主张每次只做最小化可行产品（MVP），然后快速迭代：
- **需求**：变成了“作为上班族，我想要一个休息空间”（不再是一本厚厚的需求规格书）。
- **Sprint 1**：搭了个草棚（最简可用，客户能体验并给出反馈）。
- **Sprint 2**：升级成简易厨房，修复屋顶漏水的 Bug。
- **Sprint 3**：升级成小木屋，但可能由于自动化测试不完备忘了加窗户。
- **Sprint 4**：修好窗户，完成砖瓦房。此时客户发现空间不够，决定下个迭代扩建为 3 居室（拥抱变化，不抵制需求变更）。

最终在不断的短周期迭代和修补中交付。不再像瀑布模型那样，等到大功告成（也可能大烂尾）才揭晓。

### 4. 实施敏捷开发的避坑指南

如果盲目上各种敏捷考核指标却忽略客观规律，敏捷就会沦为“微观管理的镣铐”。实施敏捷开发需满足：
1. **团队规模受控**：人数超过两张披萨能喂饱的规模（Two-pizza rule）就要分拆，通常 7±2 人最佳。
2. **紧密沟通与赋能**：内部协作透明，领导要支持“自发组织团队”，给工程师自主权。
3. **强健的工程基础**：写代码要有自动化测试兜底，否则重构就是“引爆地雷”。
4. **【AI 时代新解】**：借助 AI Agent 分配任务、甚至自动根据需求生成测试骨架，缓解“没空写文档和测试”的焦虑。

> **软件开发最核心的是人**。如果不具备全面敏捷的条件（如甲乙双方是死板的外包合同制），可以先局部借鉴持续集成、每日站会等优秀实践。

---

## 第二讲：大厂敏捷方法剖析（上篇：核心流程与基建）

### 1. 分而治之的大型工程策略

在庞大的科技巨头阵营里，项目开发的核心思想是典型的“分而治之”：
**大项目拆成小项目，大服务拆成微服务，大团队拆成小团队。**
底层依赖云原生环境、容器（Docker/K8s）等基础设施提供物理隔离，团队依赖标准 API 协议进行协同配合。只要组织扁平，庞然大物也能像初创公司一样灵活穿梭。

### 2. 一切工作围绕 Ticket（看板流转）开展

无论是报 Bug、提需求，还是重构一段冗余代码——只要是投入时间精力的活动，都必须发起一个 **Ticket（工单）**。
- 看板严格划分为 **To Do（待办）、In Progress（进行中）、Done（已完成）** 栏。
- 每天上班第一件事，就是对着看板掌控 Sprint 进度。
- **AI 赋能实践**：现代 Jira 已经接入大模型，不仅能对 Ticket 去重，还能自动把一句话需求扩写为包含“鉴权、响应、报错”的标准边界验收条件（AC）。

### 3. 基于 Git 和 CI 的自动化防线（代码准入基石）

大厂之所以敢于一天发布上百次，靠的绝不是运气，而是冰冷的流水线纪律：
- **代码审查（Code Review）防御阵地**：不直接提交到主干（master），而是开分支（branch）。完成后提交 PR（Pull Request），要求同行检视并给出 Approve。
- **持续集成（CI）的不知疲倦**：CI 机器人会在 PR 提交后立刻觉醒——自动校验代码格式、执行安全漏洞扫描、运行全量的单元测试。
- **AI Code Review 的介入**：很多公司开始在 CI 流水线中嵌入 AI 节点，AI 在 10 秒内就能给出代码逻辑缺陷、性能隐患的初步评审，减少人类 Reviewer 的负担。

PR 能够被放行合并的前提 = **CI 测试绿灯通行 + 人类（或 AI）Review 认可**。

### 4. 每日站立会议（Daily Standup）的核心效用

站会不是漫长的批斗会和表功会，控制在 15 分钟内，讲究：
1. **灵魂三问**：昨天干了什么？今日有什么计划？遇到了什么阻碍无法推进？
2. **动态甄别**：梳理新提单的紧急 Bug 和高优需求，安排插队或者放入积压池(Backlog)。
3. **问题停车场（Parking Lot）**：遇到复杂技术争论要立刻“掐断”，将该议题停回“停车场”，会后只拉相关当事人单挑解决。

---

## 第三讲：大厂敏捷方法剖析（下篇：一个小组的一周）

### 1. 敏捷团队的标准配置（斯巴达小分队）

维护某个大厂核心业务模块的一个典型敏捷小组配置（约 7 人）：
- **产品经理 (Product Owner)**：从业务口径挖掘真实诉求，转化为看板上的 Ticket。
- **开发人员 (约 4 人，含资深架构)**：按照优先级从 To Do 栏认领任务，实施交付。
- **测试人员 (1 人)**：维护自动化用例，保障交付底线，找 Bug 并报 Ticket。
- **项目经理 (Scrum Master)**：保障流程运转的润滑剂，核心任务是替开发扫除外围障碍（如借调机器、沟通跨组依赖）。

### 2. 精密咬合的“一周开发核心节奏”

整个小组的生物钟完全围绕这套周历运行：
- **上半周：部署生产环境**。永远不要在周五发版！上半周发版能确保出现故障时大家都在工位上，有充足时间响应回滚与抢修。
- **每周二清晨：迭代回顾会议（Sprint Retrospective）**。站会后进行复盘，灵魂发问：“上周哪些实践可以保留？哪些必须抛弃？”。定下的小组规矩（如“下班前 1 小时不合并代码”）会被严格执行。
- **每周四清晨：迭代规划会（Sprint Planning）与“估算扑克”**。评估工作量时，全员对每个 Ticket 独立打分，然后同时亮牌。差异巨大时要求最高分和最低分的同事辩论。这能有效避免盲目乐观（专家忽略了新手配置环境的时间）并促进知识共享。
- **每周五下午：分支切割（Branch Cut）**。由于周末休息，周五下午会把能够上线的稳定代码从主干切割出一条“预发布分支”交给 QA 专心兜底测试，而主干代码可以继续放飞自我搞下周的开发。

### 3. 三道防线：为什么这种高压节奏不会让产品崩塌？

1. **极高比例的自动化测试覆盖率**：通过率不达标（如 80% 代码覆盖率）被 CI 直接拦截，人情和面子统统无效。
2. **极短的反馈弧**：代码合入和环境出包往往只需要数分钟。
3. **责任到人与快速追查**：因为改动小而频，出现 Bug 后可以利用 Git 历史精准定位到特定的代码提交者。这种透明度促使开发提升自检质量。

---

## 第四讲：项目管理的核心博弈——质量金三角

### 1. 软件工程的“不可能三角”

现实生活和工程领域一样残酷，面对“多、快、好、省”的执念，你通常无法全部兼得。软件项目管理遵循着严酷的**金三角法则**：

- **三个顶点/约束边**：时间（进度）、成本（资源/预算）、范围（功能规模）。
- **中心与底线**：**质量**（这是系统存活的尊严，轻易不可触碰）。
- **硬核法则**：如果客户压缩了时间要求，你必须做选项：或者增加成本（投入更多开发/外包），或者大幅削减产品范围（只做核心骨干）。如果你妄图既不加人，也不砍需求，硬要在短期内赶工完，那么崩塌的一定是处于中心位置的**产品质量**。

### 2. 面对不合理要求的推诿与破局技巧

- **场景 A：老板压缩工期（要求 3 个月的系统 1 个月上线）**
  - **初级工程师思路**：硬怼老板不讲理，然后无奈疯狂加班，最终造出一坨无法维护的屎山代码。
  - **基于金三角的解法**：承认时间受制，但发起反制：“我们可以 1 个月上线，但由于时间腰斩，我们需要锁定**缩小版的 MVP 范围**（砍功能），或者您拨一笔预算给我们购买成熟商业组件/呼叫外包支援（加成本）。” 把选择题抛回给决策层。
- **场景 B：产品经理在迭代中强行塞入重型新需求**
  - 这意味着范围（体量）突变。应对方式：微笑接受，但严厉指出金三角的变形：“新功能可以做，但原本定好的上线日必须**延期交付**，要么申请预算**增加开发人手**来并行推进。”

### 3. 瀑布 vs 敏捷在金三角博弈上的底层分歧

- **传统瀑布路线（固定范围）**：为了执行数额巨大的乙方合同，功能范围是神圣不可侵犯的铁令。一旦出现技术难关变故（常态），为了咬牙交付所有功能，结果往往是时间和成本不可控地双双爆雷，演变成灾难性的长期拖欠和死扛。
- **敏捷迭代路线（固定时间与成本）**：敏捷团队认为人的精力和 1 周的时间是恒定的。既然时间和成本固定，要死守质量底线，**那就果断将范围变为动态裁剪的蓄水池**。本周遇到阻力，就把优先级较低的看板卡片踢出去，等下个周期再说。谁优先级高做哪个，这保证了项目的脉搏始终是在跳动的，而非休克。

---

## 第五讲：不重视“可行性分析”的悲惨收场

作为软件工程标准的敲门砖，“可行性研究”总是被大部分狂热的团队所忽视，他们认为这只是一种流于形式的企业公文。

通常有以下三种托辞：
1. **“需求太模糊了，没法做可行性分析。”**（事实：如果连做个预演和评估都模糊，那直接冲进去写代码注定是一场无底洞的盲人摸象。）
2. **“老板拍板了必须干，分析出不可行有毛用？”**（事实：它是帮助你在暴雷后用来防范甩锅和反噬的免责法宝，或者促使老板变更战术的最后机会。）
3. **“我们在搞互联网敏捷试错，繁文缛节会拖慢我们。”**（事实：这是胡乱使用敏捷概念的典型。最小化试错本身就是用极小成本去验证“可行性”，而不代表直接铺重兵上马死磕。）

### 惊心动魄：大厂跨端框架（React Native）的史诗级翻车惨案

曾几何时，为了节约 Android / iOS 脱节产生的维护人力，某一线互联网战区决定全面将移动端底座重构成 React Native (RN) 体系。我们用三大基本可行性维度剖析这场血案：

- **A 面：经济可行性调研（全员兴奋）**
  10人发轫，历时半年的重铸期，人力与硬件开销超百万元。但只要两端合一，预计下半年就能省下巨额双端开发人力并回撤盈利。**从经济账面看，天长地久，稳妥可行！**

- **B 面：技术可行性调研（游刃有余）**
  前端与移动端架构师摸底了RN的组件库；虽然老旧机型的渲染有些水土不服、视频流插件需要硬抗攻坚，但总体而言不存在彻底的逻辑死结。**在精锐部队眼中，技术没有生死死穴，安全通过！**

- **惨绝人寰的 C 面：社会（法律与合规）可行性被无情击穿**
  大部队历尽摧残终于快将新底座落成的当口，法务部的天团在进行全盘溯源盘点时，惊恐地发现了一个隐藏在开源协议夹层里的恶魔。
  当时 Facebook 主推的开源条款中，竟然捆绑了一项“BSD + 专利”的恶霸协议——大概意思是：你可以免费使用我的代码，但如果你因为任何其他项目和Facebook名下的企业发生专利诉讼，你在此使用的授权将会被立刻抽离剥夺。
  这意味着，只要该大厂的任意边缘出海业务在法庭上惹到了 Facebook，自家最核心的主APP会瞬间被判定为“非法调用盗版代码”，面临被各大应用商店和法庭全面绞杀的毁灭性系统断崖。

- **尾声：百万元化为齑粉的落幕**
  此时无论是架构尊严还是先前的宏大理想均被粉碎，整个部门大半年打造的代码和系统只能悉数推翻、连根拔起并销毁。如果在当初点亮代码库之前，哪怕只是花20分钟让法务执行一次“合规可行性”梳理，这场浩劫本可完全避免。

> **终极忠告**：可行性报告不是拿来给甲方看的花架子。买房、租房、技术重构前，不要光算计跑分（技术可行性）和价格（经济可行性），切勿忘了检查协议背景、合同套路和隐雷（社会/法律可行性）。对未知存疑？请立即停止梭哈，退回用最廉价的“最小化可行产品 (MVP)”执行投石问路。

---

## 阶段作业与下周预告

📋 **课后思考题：项目金三角的极限推演（《构建之法》名篇试炼）**

任何乙方或者上帝客户在提需求时，都患有极其贪婪的“大满贯并发症”：既希望能够“立竿见影马上交付”，又要“价格极其低廉乃至免费”，并且还要加上“没有任何缺陷且功能涵盖天地”。作为技术统筹者，请开启脑洞并给出你的应对法则：

1. 如果你向客户那“**限期10天必须完成、且经费已经腰斩至原始三分之一**”的可怕条件低头，为了捍卫底线的健壮与安全，你将在最终交工日抛出一个怎样奇特的变形系统？
2. 假设你的外包团队答应了某初创团队“免费为你们搭建一套底层数据平台，并且保证在下个月底前火速拉平送达”的离谱条款。在没有任何利益刺激和容错时间的温床里，你认为这套系统最终会长出什么“怪异而危险的特质”？

*(请结合质量金三角，思考这其中的博弈艺术与防线法则。)*

🔭 **下周预告：项目实操规划与控制网（第 4 周）**
团队规模逐步扩大后，如何拆解如乱麻般的工作栈？我们将一起打通全系经络：WBS 动作拆解连招法 → 用甘特图排布进度版权 → 应对各种变故与背刺的终极风险缓冲盘。
