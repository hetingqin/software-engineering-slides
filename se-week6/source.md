# 软件工程及体系结构 · 第 6 周

## 架构设计与技术选型：搭好大厦的承重墙

> 计算机相关专业本科/硕士 | 3 学时

---

## 第一讲：撕下神秘面纱的“架构设计”

早年生猛的英雄主义（求伯君一个人写 WPS）已经不复存在，如今全是百万行量级的怪物系统。怎么让一堆极其普通的程序员，拼合出一个复杂的巨型系统？靠的就是**架构体系**。

### 1. 为什么需要架构？（控制四大失控点）
- **需求在疯长**：不分离界面和逻辑，改个背景色可能连数据库都要崩飞。
- **人员在激增**：几十人挤在一个文件里改代码，Git 冲突到让人砸电脑。
- **神仙难救的并发高压**：王力宏发个微博就能搞垮几百台服务器，普通的流水账代码根本扛不住高并发。

### 2. 架构设计的本质
> 架构的道 = 将巨无霸**分拆**成沙粒，再用**接口和协议**将它们无缝咬合拼装！

### 3. 如何手握权杖做架构？底座四部曲

- **Step 1: 榨取用例树 (分析需求)**
  先别想用什么语言，先画图：有几种人？在哪里点击？干什么？
  ![用例图](../../assets/af6b79d303f126d9e2f547b1a604ef22.png)

- **Step 2: 抄作业 (选取经典成熟套路)**
  业界套路千万条。最稳妥也是最经典的就是：**经典分层架构 (四层防御隔离体系)**。UI死了不影响业务处理，底层数据库换了引擎表层毫无感知！
  ![层级架构](../../assets/eb230b721a36aaed80afbfd7641abf88.png)

- **Step 3: 自顶向下的精钻**
  部署的演进：买一台机器裸奔 -> 发现挂机断网流失客户 -> 砸钱上 **异地多活** （杭州机房被火烧了，内蒙古机房 1 秒无缝顶上！）
  ![多活部署](../../assets/35f3abd053654cd23896c7259d5258c0.png)

- **Step 4: 验证防坑**
  没有完美的架构，只有最适合当下的。预留弹性接口，用真实并发量来击穿测设。

---

## 第二讲：技术大坑与门派抉择（技术选型）

知乎上整天都在爆发战争：“PHP 是不是最好的语言？”“React 秒杀 Vue 几条街？”。当你要拍板一个绝密项目，绝不能用粉圈思维！

### 1. 认清伪命题：杀鸡别用牛刀
一堆极客热衷于什么新技术火就上什么：
> “老板，咱们系统太卡了！我要花三个月做容器化微服务切割，引入最新的 NoSQL！”
> “等等，老弟，我查了一下后台……你特么只是忘了给数据库建索引（加上索引直接快 20 倍）！”
![真香漫画](../../assets/fe1f72418d928840b0412e25e734b3f3.png)

### 2. 技术选型的金三角镣铐

把选型看成“公司拿钱做赌博”，永远框定在这三大死律中：
- **时间：** 老总下令下周一必须见活产品。哪怕你 C++ 封神，你也得乖乖用 Python/JS 库迅速搭个草台班子！
- **钱与成本：** 给 5 万块钱预算你就别提找三五个 Java 高手搞微服务全家桶。
- **安全边界：** 新技术很香，但万一这玩意开源协议霸王条款要收高额专利费呢？（防猝死 B 计划）。

**拒绝“先开枪再画靶子”：**
千万别因为自己私心极其狂热喜欢某冷门语言，就在选型表上疯狂填造对其有利的虚假证据，这是坑害全团队的职场犯罪。

---

## 第三讲：元帅的权杖——不想当架构师的不是好码农

> 拿破仑：“每个法国士兵的背包里，都装着一根元帅的权杖。”

拿破仑并不是鼓吹所有人都当司令，而是如果不具备**大局观和鸟瞰战场的元帅思维**，你永远是个炮灰。普通码农如何觉醒？

### 1. 架构师的四大底片思维

- 🧠 **抽象：剥离骨架**
  小学生鸡兔同笼，鸡是x，兔是y。程序员：视频课和图文课代码几乎一样，抽离出一个终极的 `Abstract_Course` 父类。
- 🔪 **分治：绞肉机切割**
  淘宝双十一流量冲顶咋办？把“交易中心”、“大促展示层”、“底盘数据库”全部切在异地不同城区的几千台机器上。
- ♻️ **复用：不要造满地轮胎**
  写过一遍的组件，只要再写一遍，就强制必须提取封装为公共类。不抄自己第二遍。
- ⏳ **迭代：别想一次生个大胖子**
  一步做完极易死亡。先搞出分层糙汉子凑合运转，随着 DAU（日活）激增，再逐步切成庞大的星环体系。

### 2. PPT 架构师的诅咒
现在有一种恐怖流派叫**PPT 架构师**：嘴里全是大词“赋能、闭环、高并发弹性下沉”。结果下沉到业务代码连个 git 都合不明白。**最狠的架构师，永远在最贴地的一线写着最核底板的代码。**

![架构师能力六边形](../../assets/115f943a2e6377cc19197dabe75e6230.jpg)

---

## 阶段作业与沙盘决断

📋 **高危决策：生死存亡的红蓝对抗**

场景：你们公司要为一个重磅国家级马拉松赛做一个抽签和检录系统。\n开发期仅剩 2 个月。你是这个项目组名义上第一顺位的带头大哥。
**实战决战：** 
1. **[技术信仰 vs 血腥现实]** 你的两个骨干手下热血沸腾：“老大，我们用极其前沿且超高性能、但咱们组都没用过的 Go 语言 + 全套云原生微服务体系来写吧，借此机会正好锤个牛逼的体系出来当开源王牌！” \n——作为要为金钱与死线担责的大哥，你该如何利用本周学的知识，去镇压他们那躁动的炫技冲动？
2. **[架构防御战]** 赛事当天早上 7 点会有 10 万人瞬间扫码入场检录。你会怎么利用**分治与异地冗余策略**防止当天服务器宕机导致全城混乱的丑闻？
